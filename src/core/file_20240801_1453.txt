Refactor database code

Date: 2024-08-01 14:53:02